<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head lang="en">
    <meta charset="UTF-8">
    <title>阿甲学子商城首页</title>
    <link href="../static/css/index.css" rel="Stylesheet"/>
    <link href="../static/css/animate.css" rel="Stylesheet"/>
    <link rel="stylesheet" href="../static/css/slide.css"/>
    <style>
        #content_box{
            display: flex;
            flex-wrap: wrap;
            flex-shrink: 0;
            width: 100%;
        }

        #content_box .good-item {
            flex-basis: 240px;
            display: flex;
            flex-direction: column;
            text-align: center;

        }

        .good-item > p {
            margin: 6px 0;
        }
    </style>
</head>
<body onload="load_data()">
<!-- 页面顶部-->
<header id="top">
    <div id="logo" class="lf">
        <img src="../static/images/header/logo.png" alt="logo"/>
    </div>
<form action="/goods/search" method="post">
    <div id="top_input" class="lf">
        <input id="input" type="text" placeholder="请输入您要搜索的内容" name="input"/>
        <div class="seek" tabindex="-1">
            <div class="actived" ></div>
<!--            <div class="seek_content" >-->
<!--                <div id="shcy" >生活餐饮</div>-->
<!--                <div id="xxyp" >学习用品</div>-->
<!--                <div id="srdz" >私人订制</div>-->
<!--            </div>-->
        </div>
        <a type="submit" class="rt"><img id="search" src="../static/images/header/search.png" alt="搜索"/></a>
    </div>
</form>
    <div class="rt">
        <ul class="lf">
<!--            <li><a href="myCollect.html" title="我的收藏"><img class="care" src="../static/images/header/care.png" alt=""/></a><b>|</b></li>-->
<!--            <li><a href="myOrder.html" title="我的订单"><img class="order" src="../static/images/header/order.png" alt=""/></a><b>|</b></li>-->
<!--            <li><a href="cart.html" title="我的购物车"><img class="shopcar" src="../static/images/header/shop_car.png" alt=""/></a><b>|</b></li>-->
<!--            <li><a href="lookforward.html">帮助</a><b>|</b></li>-->
            <li><span id="islogin" onclick="show()" th:text='${session.name}'></span></li>
            <li style="display: none" class="ishidden"><a href="/user/myInfo">我的信息</a></li>
            <li style="display: none" class="ishidden"><a href="/address/">收货地址</a></li>
<!--            订单未完成-->
            <li style="display: none" class="ishidden"><a href="/user/order">我的订单</a></li>
            <li style="display: none" class="ishidden"><a href="/order/toCartPage">购物车</a></li>
            <li style="display: none" class="ishidden"><a href="/user/login" onclick="loginout()">登出</a></li>
<!--            <span id=value></span>-->
<!--            <p th:text='${session.name}'></p>-->


        </ul>
    </div>
</header>
<div id="content_box">

</div>



<!-- 品质保障，私人定制等-->
<div id="foot_box">
    <div class="icon1 lf">
        <img src="../static/images/footer/icon1.png" alt=""/>
        <h3>品质保障</h3>
    </div>
    <div class="icon2 lf">
        <img src="../static/images/footer/icon2.png" alt=""/>
        <h3>私人定制</h3>
    </div>
    <div class="icon3 lf">
        <img src="../static/images/footer/icon3.png" alt=""/>
        <h3>学员特供</h3>
    </div>
    <div class="icon4 lf">
        <img src="../static/images/footer/icon4.png" alt=""/>
        <h3>专属特权</h3>
    </div>
</div>
<!-- 页面底部-->
<div class="foot_bj">
    <div id="foot">
        <div class="lf">
             <p class="footer1"><img src="../static/images/footer/logo.png" alt="" class=" footLogo"/></p>
             <p class="footer2"><img src="../static/images/footer/footerFont.png" alt=""/></p>
            
        </div>
        <div class="foot_left lf" >
            <ul>
                <li><a href="#"><h3>买家帮助</h3></a></li>
                <li><a href="#">新手指南</a></li>
                <li><a href="#">服务保障</a></li>
                <li><a href="#">常见问题</a></li>
            </ul>
            <ul>
                <li><a href="#"><h3>商家帮助</h3></a></li>
                <li><a href="#">商家入驻</a></li>
                <li><a href="#">商家后台</a></li>
            </ul>
            <ul>
                <li><a href="#"><h3>关于我们</h3></a></li>
                <li><a href="#">关于阿甲</a></li>
                <li><a href="#">联系我们</a></li>
                <li>
                    <img src="../static/images/footer/wechat.png" alt=""/>
                    <img src="../static/images/footer/sinablog.png" alt=""/>
                </li>
            </ul>
        </div>
        <div class="service">
            <p>阿甲商城客户端</p>
            <img src="../static/images/footer/ios.png" class="lf">
            <img src="../static/images/footer/android.png" alt="" class="lf"/>
        </div>
        <div class="download">
            <img src="../static/images/footer/erweima.png">
        </div>
		<!-- 页面底部-备案号 #footer -->
            <div class="record">
                &copy;2017 阿甲集团有限公司 版权所有 京ICP证xxxxxxxxxxx
            </div>
    </div>
</div>
<script src="../static/js/jquery-3.1.1.min.js"></script>
<!--<script src="../static/js/index.js"></script>-->
<script>
    //手风琴效果
    $(function () {
        $(".bellows_content-wrapper").hide();
        $(".bellows_header").click(function (){
            $(this).next().slideDown()
            $(this).parent(".bellows_item").addClass("bellows_open")
            $(".bellows_header").not(this).next().slideUp()
            $(".bellows_header").not(this).parent(".bellows_item").removeClass("bellows_open")
        });
        $('.bellows_header').on('click', 'h3', function (e) {
            $(e.target).removeClass('active').siblings('.active').addClass('active');
        });
    })
</script>
<script src="../static/js/slide.js"></script>
<script>
    $('.ck-slide').ckSlide({
        autoPlay: true,//默认为不自动播放，需要时请以此设置
        dir: 'x',//默认效果淡隐淡出，x为水平移动，y 为垂直滚动
        interval:3000//默认间隔2000毫秒
    });
    //搜索页面跳转
    $("#search").click(function(){
    	var search = document.getElementById("input").value;
    	localStorage.setItem("searchData",search);
    	$.ajax({
            type: "POST",
            url: "/goods/search",
            data:{"search":search},
            success: function () {
            },

        })
        window.location.href = "/goods/toSearch";
    })

</script>
<script>

    // document.getElementById("value").innerHTML = loginSession;
    //需要解决的点：1.js怎么判断有没有session ，:补充：session作用域
    // if(session 不为空){获取主页登录节点，并把它修改为 "欢迎+用户名"}else{登录按钮}
function load_data() {
    // var loginSession = localStorage.getItem("name");
    // var test = "aaa";
    // var  ='<%=session.getAttribute(name)%>';
    var islogin = document.getElementById('islogin');
    var ishidden = document.getElementsByClassName('ishidden');
    var  loginSession = islogin.innerText;
    if(loginSession != null && loginSession != "" && loginSession != undefined)
    {
        for (var i = 0; i<ishidden.length;i++) {
            ishidden[i].style.display="block";
        }
    }else
    {
        islogin.innerHTML = '<a href="/user/login">登录</a>';
    }
}
// var isloginSelect = "<select οnchange='clickChange()'><option>我的信息</option><option>收货地址</option><option>登出</option></select>";
// function show() {
//     var islogin = document.getElementById('islogin');
//     islogin.innerHTML = islogin.innerText+isloginSelect;
// }

</script>

<script>
    // function toGoodsInfo(id) {
    //     if (id){
    //         window.location.href = "/goods/"+id;
    //     }else {
    //         window.location.href = "templates/404.html";
    //     }
    // }
    // var id = location.pathname.match(/[^(\/goods\/)]/g)[0];
    const toGoodsInfo = id => window.location.href =  id ? "/goods/detail" : "goods/404";

    $.ajax({
        type: "post",
        url:"/goods/listAll",
        data:{},
        async: false,
        success:function (data) {
            var str = "";
            $.each(data,function(index,element){
                str +="<div class='good-item' data-good-id="+element['goodsid']+">" +
                    "<img src="+element['goodsimagename']+">" +
                    "<p>"+element['goodsname']+"</p>" +
                    "<span class='price'b>￥</b><span class='priceContent'>"+element['goodsunitprice']+"</span></span>" +
                    "</div>";
            })
            $("#content_box").append(str);
            $('.good-item').click(function ()  {
                const id  = $(this).attr('data-good-id');
                sessionStorage.setItem("goodsId",id);
                toGoodsInfo(id);
            })
        }
    })
    function loginout() {
        // localStorage.clear();
        sessionStorage.clear();
    }


</script>





</body>
</html>
