<!DOCTYPE html>
<html class="x-admin-sm">
    
    <head>
        <meta charset="UTF-8">
        <title>欢迎页面-X-admin2.2</title>
        <meta name="renderer" content="webkit">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta name="viewport" content="width=device-width,user-scalable=yes, minimum-scale=0.4, initial-scale=0.8,target-densitydpi=low-dpi" />
        <link rel="stylesheet" href="../../static/css/font.css">
        <link rel="stylesheet" href="../../static/css/xadmin.css">
        <script src="../static/js/jquery-3.1.1.min.js"></script>
        <script src="../../static/lib/layui/layui.js" charset="utf-8"></script>
        <script type="text/javascript" src="../../static/js/xadmin.js"></script>
    </head>
    
    <body>

        <div class="layui-fluid">
            <div class="layui-row layui-col-space15">
                <div class="layui-col-md12">
                    <div class="layui-card">
                        <div class="layui-card-body " id="table">

<!--                                <tbody>-->
<!--                                    <tr>-->
<!--                                        <td>-->
<!--                                            <input type="checkbox" name="" lay-skin="primary"></td>-->
<!--                                        <td>2017009171822298053</td>-->
<!--                                        <td>老王:18925139194</td>-->
<!--                                        <td>7829.10</td>-->
<!--                                        <td>未发货</td>-->

<!--                                        <td>2017-08-17 18:22</td>-->
<!--                                        <td class="td-manage">-->
<!--                                            <a title="处理" onclick="dealOrder()">-->
<!--                                                <i class="layui-icon">&#xe63c;</i></a>-->

<!--                                        </td>-->
<!--                                    </tr>-->

                                </tbody>
                            </table>
                        </div>

                    </div>
                </div>
            </div>
        </div>
    </body>
    <script>
        $.ajax({
            type: "POST",
            url:"/order/list",
            data:{},
            async: false,
            success:function (data) {
                var str = "<table class='layui-table layui-form'>                                " +
                    "<thead>                                    " +
                    "<tr>                                        " +                     " +
                    "<th>订单编号</th>                                        " +
                    "<th>收货人</th>                                        " +
                    "<th>总金额</th>                                        " +
                    "<th>订单状态(0为未处理,该页面只显示未处理订单)</th>                                        " +
                    "<th>下单时间</th>                                        " +
                    "<th>操作</th></tr>                                " +
                    "</thead>";
                $.each(data,function (index,element) {
                    str +="<tbody>" +
                        "                                    <tr>" +
                        "                                        <td>" +
                        "                                            <input type='checkbox' name='' lay-skin='primary'></td>" +
                        "                                        <td>"+element['orderid']+"</td>" +
                        "                                        <td>"+element['customername']+"</td>" +
                        "                                        <td>"+element['totalmoney']+"</td>" +
                        "                                        <td>"+element['orderstate']+"</td>" +
                        "                                        <td>"+element['orderdate']+"</td>" +
                        "                                        <td class='td-manage'>" +
                        "                                            <a title='处理' onclick='dealOrder("+element['orderid']+")'>" +
                        "                                                <i class='layui-icon'>&#xe63c;</i></a>" +
                        "                                        </td>" +
                        "                                    </tr>";
                })
                str += "</tbody></table>";
                $("#table").append(str);
                },
            error: function (xhr, textStatus, errorThrown) {
                /*错误信息处理*/
                alert("进入error---");
                alert("状态码："+xhr.status);
                alert("状态:"+xhr.readyState);//当前状态,0-未初始化，1-正在载入，2-已经载入，3-数据进行交互，4-完成。
                alert("错误信息:"+xhr.statusText );
                alert("返回响应信息："+xhr.responseText );//这里是详细的信息
                alert("请求状态："+textStatus);
                alert(errorThrown);
                alert("请求失败");
            }

            }
        )
        function dealOrder(id) {
            $.ajax({
                type:"POST",
                url:"/order/deal",
                data: {"id":id},
                success:function () {
                    window.alert("订单处理成功！");
                    window.location.reload();
                }
            })
        }
    </script>

</html>